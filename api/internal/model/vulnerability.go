package model

import (
	"encoding/json"
	"time"
)

type Vulnerability struct {
	ID            string          `json:"id"`
	OrgID         string          `json:"orgId"`
	Title         string          `json:"title"`
	Description   string          `json:"description"`
	Source         string          `json:"source"`
	CVEIDs        []string        `json:"cveIds"`
	ExternalRefs  json.RawMessage `json:"externalRefs"`
	CVSSScore     *float64        `json:"cvssScore"`
	CVSSVector    string          `json:"cvssVector"`
	Severity      string          `json:"severity"`
	Status        string          `json:"status"`
	DiscoveryDate *time.Time      `json:"discoveryDate"`
	DueDate       *time.Time      `json:"dueDate"`
	ClosureDate   *time.Time      `json:"closureDate"`
	OwnerID       *string         `json:"ownerId"`
	AnalystID     *string         `json:"analystId"`
	ApproverID    *string         `json:"approverId"`
	Tags          []string        `json:"tags"`
	Notes         string          `json:"notes"`
	CreatedAt     time.Time       `json:"createdAt"`
	UpdatedAt     time.Time       `json:"updatedAt"`
}

type VulnerabilityHistory struct {
	ID              string    `json:"id"`
	VulnerabilityID string    `json:"vulnerabilityId"`
	ChangedBy       string    `json:"changedBy"`
	FieldName       string    `json:"fieldName"`
	OldValue        string    `json:"oldValue"`
	NewValue        string    `json:"newValue"`
	ChangedAt       time.Time `json:"changedAt"`
}
